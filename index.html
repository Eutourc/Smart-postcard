<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Smart Postcard ‚Äî EN v7.0</title>
<meta http-equiv="Cache-Control" content="no-store" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<style>
  :root{
    --bw-c1:#10b981; --bw-c2:#22d3ee; --bw-c3:#34d399;
    --brandword-size:26px;
    --title-size:23px;
    --gapTop:26px;
    --title-lh:1.06;
    --gap2:28px;
    --gap3:31.5px;
    --sideGapL:24px;
    --sideGapR:25px;

    /* ‚úÖ explain box background aligned to CN */
    --explain-bg:#FFF8D9;

    --card-border:1px;
    --card-border-color:#d1d5db;
    --arrow-fat:22px;
    --arrow-width:26px;
    --ex-pad-y:10px;
    --ex-pad-x:18px;
    --marker-fat:16px;
    --marker-base:13px;
    --marker-color:#16a34a;
  }
  *{box-sizing:border-box}
  html,body{
    margin:0;background:#fff;color:#222;
    font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  }
  img{max-width:100%;display:block}
  .top{position:sticky;top:0;z-index:10;background:#F5B800;box-shadow:0 2px 12px rgba(0,0,0,.08)}
  .bar{max-width:980px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 14px}
  .brand{display:flex;align-items:center;gap:10px}
  .brand img{width:64px;height:64px;object-fit:contain}
  .brandword{display:flex;flex-direction:column;line-height:1}
  .brandword .l1,.brandword .l2{
    font-weight:900;font-size:var(--brandword-size);letter-spacing:.5px;
    background:linear-gradient(90deg,var(--bw-c1),var(--bw-c2) 55%,var(--bw-c3));
    -webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;
  }
  .actions{display:flex;align-items:center;gap:8px; position:relative;}
  .iconbtn{width:40px;height:40px;display:grid;place-items:center;border-radius:50%;background:#fff;box-shadow:inset 0 0 0 1px rgba(0,0,0,.08)}
  .cart{position:relative}
  .badge{position:absolute;right:-6px;top:-6px;background:#ff4d4f;color:#fff;border-radius:8px;padding:0 5px;font-size:10px;line-height:16px;min-width:16px;height:16px;font-weight:800}

  /* ===== Language pill (avoid flags for CN/TC/EN) ===== */
  .langpill{
    display:flex;align-items:center;gap:8px;
    padding:8px 10px;border-radius:999px;background:#fff;
    box-shadow:inset 0 0 0 1px rgba(0,0,0,.08);
    cursor:pointer; user-select:none;
  }
  .langcode{
    min-width:26px;
    height:18px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:900;
    font-size:12px;
    letter-spacing:.2px;
    color:#111;
  }
  .flagemoji{
    font-size:16px;
    line-height:1;
    transform:translateY(-.5px);
  }
  .caret{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:6px solid #222}
  .menu{font-size:22px;font-weight:900}

  /* dropdown */
  .langmenu{
    position:absolute;
    right:54px; /* aligns under pill, without overlapping menu icon */
    top:54px;
    width:180px;
    background:#fff;
    border-radius:14px;
    box-shadow:0 10px 24px rgba(0,0,0,.18);
    padding:8px;
    display:none;
    z-index:50;
  }
  .langmenu.show{display:block;}
  .langitem{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    padding:10px 12px;
    border-radius:12px;
    cursor:pointer;
    font-weight:800;
    color:#111;
    line-height:1.1;
  }
  .langitem:hover{background:rgba(245,184,0,.18);}
  .langleft{display:flex; align-items:center; gap:10px;}
  .pillmini{
    min-width:30px;
    height:18px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:900;
    font-size:12px;
    border-radius:6px;
    background:rgba(0,0,0,.06);
    color:#111;
  }
  .langname{font-weight:800; font-size:13px;}
  .langnote{font-weight:700; font-size:12px; color:#6b7280;}
  .langsep{height:1px; background:rgba(0,0,0,.08); margin:6px 4px;}

  main{max-width:980px;margin:0 auto;min-height:100svh;display:flex;flex-direction:column;padding:0 14px 12px}
  .gapTop{height:var(--gapTop);}
  .gap2{height:var(--gap2);}
  h1.page-title{font-size:var(--title-size);line-height:var(--title-lh);font-weight:800;text-align:center;margin:0;}
  .stage{
    display:flex;flex-direction:column;
    background:#fff;border-radius:20px;
    padding-left:var(--sideGapL);padding-right:var(--sideGapR);
  }
  .explain{
    position:relative;
    display:inline-block;
    align-self:center;
    padding:var(--ex-pad-y) var(--ex-pad-x);
    border-radius:14px;
    background:var(--explain-bg);
    font-size:14px;
    line-height:1.16;
    text-align:center;
  }
  .explain-keeper{
    visibility:hidden;
    white-space:normal;
  }
  #explain-text{
    position:absolute;
    left:var(--ex-pad-x);
    right:var(--ex-pad-x);
    top:var(--ex-pad-y);
    bottom:var(--ex-pad-y);
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    font-size:14px;
    line-height:1.16;
  }
  .viewer{
    position:relative;
    margin-top:var(--gap3);
  }
  .cardbox{
    position:relative;width:100%;margin:0;
    border-radius:0;overflow:visible;background:#fff;
    border:var(--card-border) solid var(--card-border-color);
    box-shadow:0 2px 6px rgba(0,0,0,.06);
  }
  .cardbox-inner{position:relative;width:100%;padding-top:70%;overflow:visible;background:#fff;}
  .cardbox-inner::before{content:none;}
  .hotspot{
    position:absolute;
    border:none;
    background:transparent;
    padding:0;
    margin:0;
    cursor:pointer;
    z-index:3;
  }
  .hotspot:focus{outline:none;}
  .hotspot-center{
    top:25.09%;
    left:46.00%;
    width:14.35%;
    height:51.20%;
  }
  .hotspot-stamp{
    top:-12.00%;
    left:79.05%;
    width:20.00%;
    height:30.00%;
  }
  .hotspot-qr1{
    top:-11.81%;
    left:48.07%;
    width:20.00%;
    height:30.55%;
  }
  .hotspot-weather{
    top:-4.63%;
    left:8.13%;
    width:42.00%;
    height:23.37%;
  }
  .hotspot-writing{
    top:27.00%;
    left:0.00%;
    width:44.50%;
    height:36.00%;
  }
  .hotspot-qr2{
    top:73.30%;
    left:2.00%;
    width:20.00%;
    height:33.43%;
  }
  .hotspot-seal{
    top:70.74%;
    left:19.00%;
    width:22.00%;
    height:35.43%;
  }
  .hotspot-address{
    top:40.00%;
    left:64.94%;
    width:28.00%;
    height:36.00%;
  }
  .hotspot-postmark{
    top:18.62%;
    left:64.51%;
    width:14.00%;
    height:16.00%;
  }
  .big-arrow{
    position:absolute;
    width:0;height:0;border:0;background:transparent;padding:0;
    pointer-events:auto;
    z-index:2;
  }
  .big-arrow.left{left:0;}
  .big-arrow.left::before{
    content:"";display:block;width:0;height:0;
    border-top:var(--arrow-fat) solid transparent;
    border-bottom:var(--arrow-fat) solid transparent;
    border-right:var(--arrow-width) solid #0b3a77;
    margin-left:calc(-1 * var(--arrow-width));
  }
  .big-arrow.right{right:0;}
  .big-arrow.right::before{
    content:"";display:block;width:0;height:0;
    border-top:var(--arrow-fat) solid transparent;
    border-bottom:var(--arrow-fat) solid transparent;
    border-left:var(--arrow-width) solid #0b3a77;
  }
  .features{
    margin-top:calc(var(--gap3) - 4px);
    text-align:center;
    font-size:14px;
    line-height:1.16;
    font-weight:700;
    color:#000000;
  }
  .features-line{display:block;}
  .features-line + .features-line{margin-top:0;}
  .cta{
    margin-top:calc(var(--gap3) - 4px);
    margin-bottom:12px;
  }
  .cta-row-top{
    display:flex;
    justify-content:center;
    column-gap:14px;
    width:100%;
    margin:0 auto;
  }
  .btn-gold,
  .btn-main{
    display:flex;
    align-items:center;
    justify-content:center;
    border-radius:22px;
    border:1px solid rgba(140,103,36,.45);
    background:linear-gradient(180deg,#ffe49b 0%, #e8be58 52%, #bf8f31 100%);
    box-shadow:
      inset 0 2px 0 rgba(255,255,255,.85),
      inset 0 -2px 0 rgba(0,0,0,.18),
      0 8px 18px rgba(0,0,0,.14);
    color:#2f2f2f;
    text-shadow:0 1px 0 rgba(255,255,255,.75),0 -1px 0 rgba(0,0,0,.18);
    font-family:inherit;
    font-weight:900;
    white-space:nowrap;
  }
  .btn-gold{
    flex:0 0 auto;
    height:38px;
    font-size:13px;
    padding:0 16px;
  }
  .btn-main{
    display:block;
    width:100%;
    margin:12px 0 0;
    height:40px;
    font-size:16px;
    border-radius:24px;
  }
  .btn-primary{color:#1e56d6;}

  .marker{
    position:absolute;
    width:0;
    height:0;
    border-left:var(--marker-base) solid transparent;
    border-right:var(--marker-base) solid transparent;
    border-top:var(--marker-fat) solid var(--marker-color);
    filter:drop-shadow(0 2px 4px rgba(22,163,74,.35));
    pointer-events:none;
    z-index:9;
  }

  .auto-play{
    position:absolute;
    right:10px;
    bottom:10px;
    width:26px;
    height:26px;
    border-radius:999px;
    border:none;
    background:#ffffff;
    box-shadow:0 2px 6px rgba(0,0,0,.3);
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    padding:0;
  }
  .auto-play::before{
    content:"‚ñ∂";
    font-size:13px;
    transform:translateX(1px);
  }
  .auto-play.playing::before{
    content:"‚Ö°";
    transform:translateX(0);
    font-size:12px;
  }
</style>
</head>

<body>
<header class="top">
 <div class="bar">
  <div class="brand">
   <img alt="Smart Postcard" src="Logo.png"/>
   <div class="brandword">
    <span class="l1">Smart</span>
    <span class="l2">Postcard</span>
   </div>
  </div>

  <div class="actions">
   <div class="iconbtn cart">
     <span style="font-size:18px">üõí</span>
     <span class="badge" id="cart-badge">0</span>
   </div>

   <!-- Language pill (CN/TC/EN use text; Nordic can use flag in menu) -->
   <div class="langpill" id="lang-pill" aria-label="Language">
     <span class="langcode" id="lang-code">EN</span>
     <span class="caret"></span>
   </div>

   <!-- Language dropdown -->
   <div class="langmenu" id="lang-menu" role="menu" aria-label="Language menu">
     <div class="langitem" data-href="en_v7.0.html">
       <div class="langleft">
         <span class="pillmini">EN</span>
         <div>
           <div class="langname">English</div>
           <div class="langnote">Baseline</div>
         </div>
       </div>
     </div>

     <div class="langitem" data-href="cn_v7.0.html">
       <div class="langleft">
         <span class="pillmini">ÁÆÄ</span>
         <div>
           <div class="langname">‰∏≠ÊñáÁÆÄ‰Ωì</div>
           <div class="langnote">Âü∫ÂáÜÁâà</div>
         </div>
       </div>
     </div>

     <div class="langitem" data-href="tc_v7.0.html">
       <div class="langleft">
         <span class="pillmini">ÁπÅ</span>
         <div>
           <div class="langname">‰∏≠ÊñáÁπÅÈ´î</div>
           <div class="langnote">tc_v7.0</div>
         </div>
       </div>
     </div>

     <div class="langsep"></div>

     <div class="langitem" data-href="sv_v7.0.html">
       <div class="langleft">
         <span class="flagemoji" aria-hidden="true">üá∏üá™</span>
         <div>
           <div class="langname">Svenska</div>
           <div class="langnote">sv_v7.0</div>
         </div>
       </div>
     </div>
   </div>

   <div aria-label="menu" class="iconbtn"><span class="menu">‚â°</span></div>
  </div>
 </div>
</header>

<main>
  <div class="gapTop"></div>
  <h1 class="page-title">Treasure Your One-Of-A-Kind<br/>Souvenir Postcard</h1>
  <div class="gap2"></div>

  <section class="stage">
    <div class="explain">
      <div class="explain-keeper">
        Please fill in the mailing address!<br/>
        Country names must be English!<br/>
        See example in the address field!
      </div>
      <div id="explain-text">
        Allow to use your own photo!<br/>
        Treasure the historic chance!<br/>
        It is one of a kind worldwide!
      </div>
    </div>

    <div class="viewer">
      <button aria-label="Previous stop" class="big-arrow left" id="prev"></button>
      <button aria-label="Next stop" class="big-arrow right" id="next"></button>
      <div class="cardbox" id="cardbox">
        <div class="cardbox-inner" id="cardbox-inner">
          <img id="pc-img" src="postcard_en.png"
               alt="Smart Postcard sample"
               style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover;display:block;border-radius:0;">
          <div class="marker" id="marker"></div>
          <button class="auto-play" id="auto-play" aria-label="Auto demo"></button>

          <button class="hotspot hotspot-center" id="hotspot-center" aria-label="Center hotspot (image / album)"></button>
          <button class="hotspot hotspot-stamp" id="hotspot-stamp" aria-label="Stamp hotspot"></button>
          <button class="hotspot hotspot-qr1" id="hotspot-qr1" aria-label="Map hotspot"></button>
          <button class="hotspot hotspot-weather" id="hotspot-weather" aria-label="Weather hotspot"></button>
          <button class="hotspot hotspot-writing" id="hotspot-writing" aria-label="Writing hotspot"></button>
          <button class="hotspot hotspot-qr2" id="hotspot-qr2" aria-label="Media hotspot"></button>
          <button class="hotspot hotspot-seal" id="hotspot-seal" aria-label="Seal hotspot"></button>
          <button class="hotspot hotspot-address" id="hotspot-address" aria-label="Address hotspot"></button>
          <button class="hotspot hotspot-postmark" id="hotspot-postmark" aria-label="Postmark hotspot"></button>
        </div>
      </div>
    </div>

    <section class="features" aria-label="Smart Postcard features">
      <div class="features-line">Easy to make ¬∑ Physical printing</div>
      <div class="features-line">Precious album ¬∑ Worldwide delivery</div>
      <div class="features-line">Travel souvenir ¬∑ Philatelic collectible</div>
      <div class="features-line">Photo printing ¬∑ A5 large size ¬∑ Great value</div>
    </section>
  </section>

  <section class="cta" aria-label="Choose postcard type">
    <div class="cta-row-top">
      <button class="btn-gold btn-primary" type="button">Souvenir postcard</button>
      <button class="btn-gold" type="button">Traditional postcard</button>
    </div>
    <button class="btn-main" type="button">Treasure Now</button>
  </section>
</main>

<script>
/* ===== Language menu: click to switch to another HTML file (all deployed together) ===== */
(function(){
  var pill = document.getElementById('lang-pill');
  var menu = document.getElementById('lang-menu');

  function closeMenu(){
    if(menu) menu.classList.remove('show');
  }
  function toggleMenu(){
    if(!menu) return;
    menu.classList.toggle('show');
  }

  if(pill){
    pill.addEventListener('click', function(e){
      e.stopPropagation();
      toggleMenu();
    });
  }

  if(menu){
    menu.addEventListener('click', function(e){
      var item = e.target.closest('.langitem');
      if(!item) return;
      var href = item.getAttribute('data-href');
      if(!href) return;
      window.location.href = href;
    });
  }

  document.addEventListener('click', function(){ closeMenu(); });
})();
</script>

<script>
(function(){
  function positionArrows(){
    var ex = document.querySelector('.explain');
    var viewer = document.querySelector('.viewer');
    var prev = document.getElementById('prev');
    var next = document.getElementById('next');
    if(!ex || !viewer || !prev || !next) return;
    var er = ex.getBoundingClientRect();
    var vr = viewer.getBoundingClientRect();
    var centerY = er.top + er.height/2;
    var y = centerY - vr.top - 22;
    prev.style.top = y + 'px';
    next.style.top = y + 'px';
  }
  window.addEventListener('DOMContentLoaded', positionArrows);
  window.addEventListener('load', positionArrows);
  window.addEventListener('resize', positionArrows);
  window.addEventListener('orientationchange', positionArrows);
})();
</script>

<script>
(function(){
  var messages = {
    1: "&nbsp;&nbsp;The postcard / stamp image!<br/>May replace it with your photo!<br/>A large A5 photo is developed!",
    2: "Allow to use your own photo!<br/>Treasure the historic chance!<br/>It is one of a kind worldwide!",
    3: "Your visiting commemoration!<br/>&nbsp;&nbsp;You can mark it on the map!<br/>Scan QR code to relive / share!",
    4: "Record a feeling, date, weather, temperature! It is the postscript<br/>&nbsp;on your map memorial point!",
    5: "&nbsp;&nbsp;&nbsp;&nbsp;Write your heartfelt words!<br/>Keep your cherished memories!",
    6: "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Record your video / audio!<br/>Scan QR code to play it back!<br/>Long-press QR code on phones!",
    7: "Add a local memorial seal!<br/>It is a witness to your visit!<br/>Long-press for AI Commentary!",
    8: "Please fill in the mailing address!<br/>Country names must be English!<br/>See example in the address field!",
    9: "Commemoration and postmark<br/>dates are guaranteed to match!",
    10:"Digital postcard album ‚Äî free!<br/>Start with five! Emailed to you!<br/>If more later, may put all in one!"
  };

  var leftOrder  = [2,3,4,5,6,7,8,9,10,1];
  var rightOrder = [2,1,10,9,8,7,6,5,4,3];
  var autoOrder  = [1,2,3,4,5,6,7,8,9,10];

  function nextIn(order, current, fallback){
    var i = order.indexOf(current);
    if(i === -1) return (fallback || order[0]);
    return order[(i+1) % order.length];
  }

  var box  = document.getElementById('explain-text');
  var left = document.getElementById('prev');
  var right= document.getElementById('next');
  if(!box || !left || !right) return;

  window.SP_state = window.SP_state || { current: 2 };
  var state = window.SP_state;

  function renderExplain(){
    box.innerHTML = messages[state.current] || "";
    var img = document.getElementById('pc-img');
    if(img){
      var n = state.current;
      var src = 'postcard_en.png';
      if(n === 1){
        src = 'oslo_ski_jump_background.jpg';
      }else if(n === 10){
        src = 'Memorial_Postcard_Album_cover_A5_landscape_plain.png';
      }
      if(img.getAttribute('src') !== src){
        img.setAttribute('src', src);
      }
    }
  }

  function syncMarker(){
    if(window.SP10_render) window.SP10_render();
  }

  function goLeft(){
    state.current = nextIn(leftOrder, state.current, 2);
    renderExplain();
    syncMarker();
  }

  function goRight(){
    state.current = nextIn(rightOrder, state.current, 2);
    renderExplain();
    syncMarker();
  }

  var AUTO_SHORT = 10000;
  var AUTO_LONG  = 10000;
  var autoTimer  = null;
  window.SP_autoRunning = window.SP_autoRunning || false;
  window.SP_autoPaused  = window.SP_autoPaused  || false;
  var autoBtn = document.getElementById('auto-play');
  var autoJustStarted = false;
  var lastAutoClick = 0;

  function clearAuto(){
    if(autoTimer){
      clearTimeout(autoTimer);
      autoTimer = null;
    }
  }

  function scheduleNext(){
    clearAuto();
    if(!window.SP_autoRunning) return;
    var delay = (state.current === 2 ? AUTO_LONG : AUTO_SHORT);
    autoTimer = setTimeout(stepAuto, delay);
  }

  function stepAuto(){
    if(!window.SP_autoRunning) return;
    if(autoJustStarted){
      autoJustStarted = false;
      state.current = 1;
    }else{
      var idx = autoOrder.indexOf(state.current);
      if(idx === -1) idx = 0;
      state.current = autoOrder[(idx + 1) % autoOrder.length];
    }
    renderExplain();
    syncMarker();
    scheduleNext();
  }

  function startAuto(){
    if(window.SP_autoRunning) return;
    window.SP_autoRunning = true;
    window.SP_autoPaused = false;
    if(autoBtn) autoBtn.classList.add('playing');
    state.current = 2;
    renderExplain();
    syncMarker();
    autoJustStarted = true;
    scheduleNext();
  }

  function stopAuto(){
    if(!window.SP_autoRunning && !window.SP_autoPaused) return;
    window.SP_autoRunning = false;
    window.SP_autoPaused = false;
    if(autoBtn) autoBtn.classList.remove('playing');
    clearAuto();
  }

  left.addEventListener('click', function(){ stopAuto(); goLeft(); });
  right.addEventListener('click', function(){ stopAuto(); goRight(); });

  function goTo(n){
    if(typeof n !== 'number') return;
    state.current = n;
    renderExplain();
    syncMarker();
  }
  function bindHotspot(id, target){
    var el = document.getElementById(id);
    if(!el) return;
    el.addEventListener('click', function(){ stopAuto(); goTo(target); });
  }
  function bindCenterHotspot(id){
    var el = document.getElementById(id);
    if(!el) return;
    var lastTap = 0;
    el.addEventListener('click', function(){
      var now = Date.now();
      var delta = now - lastTap;
      lastTap = now;
      stopAuto();
      if(delta > 0 && delta < 400){ goTo(10); }
      else{ goTo(1); }
    });
  }

  bindCenterHotspot('hotspot-center');
  bindHotspot('hotspot-stamp', 2);
  bindHotspot('hotspot-qr1', 3);
  bindHotspot('hotspot-weather', 4);
  bindHotspot('hotspot-writing', 5);
  bindHotspot('hotspot-qr2', 6);
  bindHotspot('hotspot-seal', 7);
  bindHotspot('hotspot-address', 8);
  bindHotspot('hotspot-postmark', 9);

  if(autoBtn){
    autoBtn.addEventListener('click', function(){
      var now = Date.now();
      var delta = now - lastAutoClick;
      lastAutoClick = now;

      if(delta > 0 && delta < 400){
        stopAuto();
        startAuto();
        return;
      }

      if(window.SP_autoRunning){
        window.SP_autoRunning = false;
        window.SP_autoPaused = true;
        if(autoBtn) autoBtn.classList.remove('playing');
        clearAuto();
      }else if(window.SP_autoPaused){
        window.SP_autoRunning = true;
        window.SP_autoPaused = false;
        if(autoBtn) autoBtn.classList.add('playing');
        autoJustStarted = false;
        scheduleNext();
      }else{
        startAuto();
      }
    });
  }

  window.SP_goLeft = goLeft;
  window.SP_goRight = goRight;
  window.SP_renderExplain = renderExplain;
  window.SP_startAuto = startAuto;
  window.SP_stopAuto = stopAuto;

  renderExplain();
})();
</script>

<script>
(function(){
  var anchors = [
    {n:1, nx:0.491168, ny:0.000456, rot:180},
    {n:2, nx:0.880461, ny:0.000000, rot:180},
    {n:3, nx:0.570673, ny:0.001898, rot:180},
    {n:4, nx:0.281333, ny:0.003738, rot:180},
    {n:5, nx:0.000000, ny:0.435712, rot:90},
    {n:6, nx:0.119237, ny:1.000000, rot:0},
    {n:7, nx:0.290871, ny:0.998160, rot:0},
    {n:8, nx:1.000000, ny:0.584399, rot:270},
    {n:9, nx:0.999215, ny:0.243292, rot:270},
    {n:10, nx:0.491168, ny:0.000456, rot:180}
  ];

  function renderMarker(){
    var marker = document.getElementById('marker');
    if(!marker) return;
    var s = window.SP_state || { current: 2 };
    var cur = typeof s.current === 'number' ? s.current : 2;
    var a = anchors.find(function(x){ return x.n === cur; }) || anchors[1];
    marker.style.left = (a.nx * 100) + '%';
    marker.style.top  = (a.ny * 100) + '%';
    var deg = (a.rot + 180) % 360;

    var offset = 9.5;
    var dx = 0, dy = 0;
    if(deg === 0){ dy = -offset; }
    else if(deg === 180){ dy = offset; }
    else if(deg === 90){ dx = offset; }
    else if(deg === 270){ dx = -offset; }

    marker.style.transform =
      'translate(calc(-50% + ' + dx + 'px), calc(-50% + ' + dy + 'px)) rotate(' + deg + 'deg) scale(0.9)';
  }

  window.addEventListener('load', renderMarker);
  window.addEventListener('resize', renderMarker);
  window.SP10_render = renderMarker;
})();
</script>

</body>
</html>